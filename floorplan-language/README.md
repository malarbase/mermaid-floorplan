# The mandatory language package

As a good entry point to our documentation, please use to this [guide](https://langium.org/docs/learn/workflow/write_grammar/).

## What's in the folder?

- [package.json](./package.json) - The manifest file of your language package.
- [tsconfig.json](./tsconfig.json) - The packages specific TypeScript compiler configuration extending the [base config](../../tsconfig.json)
- [src/floorplans.langium](src/floorplans.langium) - The grammar definition of your language
- [src/floorplans-module.ts](src/floorplans-module.ts) - The dependency injection module of your language implementation. Use this to register overridden and added services.
- [src/floorplans-validator.ts](src/floorplans-validator.ts) - An example validator. You should change it to reflect the semantics of your language.
- [src/generated/ast.ts](src/generated/ast.ts) - AST generated by `langium generate`.
- [src/generated/grammar.ts](src/generated/grammar.ts) - Grammar generated by `langium generate`.
- [src/generated/module.ts](src/generated/module.ts) - Module generated by `langium generate`.
- [src/generated/syntaxes/floorplans.monarch.ts](src/generated/syntaxes/floorplans.monarch.ts) - Monarch based syntax highlighting instructions.
- [src/generated/syntaxes/floorplans.tmLanguage.json](src/generated/syntaxes/floorplans.tmLanguage.json) - Textmate based syntax highlighting instructions.
- [src/index.ts](src/index.ts) Defines what is exported to other packages.

If you selected the test option as well, then the following files will be present in addition:

- [tsconfig.test.json](./tsconfig.test.json) - The package specific TypeScript compiler configuration for the unit tests extending the [tsconfig.src.config](./tsconfig.src.json)
- [test/linking.test.ts](test/linking.test.ts) - Unit tests checking linking.
- [test/parsing.test.ts](test/parsing.test.ts) - Unit tests regarding parsing.
- [test/validating.test.ts](test/validating.test.ts) - Unit tests regarding validation.

## DXF Export

The floorplan-language package supports exporting floorplans to DXF (AutoCAD Drawing Exchange Format). DXF files can be opened in CAD software like AutoCAD, LibreCAD, and Illustrator.

### Features

- **Layered output**: Content is organized into layers (WALLS, DOORS, WINDOWS, ROOMS, LABELS, DIMENSIONS, STAIRS, LIFTS)
- **Room outlines**: Closed polylines representing room boundaries
- **Door/window openings**: Wall gaps with appropriate symbols
- **Room labels**: Text labels with room names and optional area
- **Dimension lines**: Optional dimension annotations
- **Multi-floor support**: Export all floors to a single DXF with vertical offsets

### Usage

#### Programmatic API

```typescript
import { exportFloorToDxf, exportFloorplanToDxf } from 'floorplan-language';

// Export a single floor
const result = exportFloorToDxf(floor, connections, {
  includeLabels: true,
  includeDimensions: false,
  wallThickness: 0.5,
  scale: 1.0,
});

// Export all floors to a single DXF
const multiResult = exportFloorplanToDxf(floors, connections, config, {
  includeLabels: true,
});

// Save to file
fs.writeFileSync('output.dxf', result.content);
```

#### CLI Script

```bash
# Export a floorplan to DXF
npx tsx scripts/export-dxf.ts input.floorplan output.dxf

# Export a specific floor
npx tsx scripts/export-dxf.ts input.floorplan output.dxf --floor "Ground Floor"

# Export with dimensions
npx tsx scripts/export-dxf.ts input.floorplan output.dxf --dimensions

# Export without labels
npx tsx scripts/export-dxf.ts input.floorplan output.dxf --no-labels

# Export all floors to one file
npx tsx scripts/export-dxf.ts input.floorplan output.dxf --all-in-one
```

### DXF Layers

| Layer | Color | Purpose |
|-------|-------|---------|
| WALLS | Gray (8) | Room wall outlines |
| DOORS | Cyan (4) | Door openings and arcs |
| WINDOWS | Blue (5) | Window openings |
| ROOMS | White (7) | Room boundary polylines |
| LABELS | Green (3) | Room name and area text |
| DIMENSIONS | Yellow (2) | Dimension annotations |
| STAIRS | Magenta (6) | Staircase symbols |
| LIFTS | Red (1) | Elevator symbols |

### Export Options

| Option | Type | Default | Description |
|--------|------|---------|-------------|
| `includeLabels` | boolean | true | Include room name labels |
| `includeDimensions` | boolean | false | Include dimension lines |
| `wallThickness` | number | 0.5 | Wall thickness in units |
| `scale` | number | 1.0 | Scale factor for output |
| `units` | string | 'ft' | Unit system (ft, m, mm, in) |
